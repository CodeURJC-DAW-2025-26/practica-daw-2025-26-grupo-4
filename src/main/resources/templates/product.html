<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{product.name}} - PlantaZon</title>

    <link rel="stylesheet" href="/styles/product.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
    <div class="app-container">


        <!-- Main -->
        <main class="main-content">

            <!-- Top bar -->
            <header class="top-bar">
                <div class="header-left">
                    <a href="/" class="back-link">
                        <i class="fa-solid fa-arrow-left"></i> Volver a la tienda
                    </a>
                </div>

                <div class="logo-center">
                    <img class="brand-logo brand-logo--sm" src="/images/logoDAW.png" alt="Logo PlantaZon">
                    <span class="brand-name">PlantaZon</span>
                </div>

                <div class="user-actions">
                    <div class="cart-icon-container">
                        <a href="/cart">
                            <i class="fa-solid fa-cart-shopping"></i>
                            <span class="badge">1</span>
                        </a>
                    </div>
                    <a href="/user">
                        <i class="fa-regular fa-circle-user profile-icon"></i>
                    </a>
                </div>
            </header>

            <!-- Product detail -->
            <div class="product-layout">

                <!-- Gallery -->
                <section class="gallery">
                    <div class="main-image">
                        <img id="mainProductImage" src="{{product.mainImage}}" alt="Imagen principal del producto">
                    </div>
                    <div class="thumbnails">
                        {{#product.images}}
                        <div class="thumbnail" onclick="changeImage(this, '{{.}}')">
                            <img src="{{.}}" alt="Miniatura">
                        </div>
                        {{/product.images}}
                    </div>
                </section>

                <!-- Info -->
                <section class="product-info">
                    <h1>{{product.name}}</h1>
                    <p class="short-desc">{{product.description}}</p>

                    <div class="tags">
                        {{#product.tags}}
                        <span class="tag">{{.}}</span>
                        {{/product.tags}}
                    </div>

                    <div class="price-row">
                        <span class="price">{{product.price}}</span>
                    </div>

                    <div class="quantity">
                        <button>-</button>
                        <span>2</span>
                        <button>+</button>
                    </div>

                    <button class="btn-buy">Comprar ahora</button>
                    <button class="btn-cart">Añadir al carrito</button>

                    <div class="recommend">
                        <h3>Completa tu pedido con</h3>
                        <a href="/product/{{recommendedProduct.id}}" class="recommend-card">
                            <img
                                src="{{recommendedProduct.mainImage}}">
                            <div>
                                <strong>{{recommendedProduct.name}}</strong>
                                <div class="tags small">
                                    {{#recommendedProduct.tags}}
                                    <span class="tag">{{.}}</span>
                                    {{/recommendedProduct.tags}}
                                </div>
                                <span class="rec-price">{{recommendedProduct.price}}€/u</span>
                            </div>
                            <div class="rec-actions">
                                <i class="fa-solid fa-cart-plus"></i>
                                <i class="fa-regular fa-heart"></i>
                            </div>
                        </a>

                    </div>
                </section>
            </div>

            <!-- Reviews -->
            <section class="reviews">

                <div class="rating-summary">
                    <span class="score">{{product.getAverageRating}} / 5</span>
                    <div>
                        <div class="stars">
                            {{#product.averageStars}}
                            <i class="{{.}}"></i>
                            {{/product.averageStars}}
                        </div>
                    </div>
                    <small>{{product.reviews.size}} valoraciones</small>
                </div>

                <div class="rating-bars">
                    <div>
                        <span>5 ★</span>
                        <div class="bar">
                            <div class="fill" style="width: {{product.percent5}}%"></div>
                        </div>
                    </div>
                    <div>
                        <span>4 ★</span>
                        <div class="bar">
                            <div class="fill" style="width: {{product.percent4}}%"></div>
                        </div>
                    </div>
                    <div>
                        <span>3 ★</span>
                        <div class="bar">
                            <div class="fill" style="width: {{product.percent3}}%"></div>
                        </div>
                    </div>
                    <div>
                        <span>2 ★</span>
                        <div class="bar">
                            <div class="fill" style="width: {{product.percent2}}%"></div>
                        </div>
                    </div>
                    <div>
                        <span>1 ★</span>
                        <div class="bar">
                            <div class="fill" style="width: {{product.percent1}}%"></div>
                        </div>
                    </div>
                </div>

                <div class="comments">
                    {{#product.reviews}}
                    <div class="comment">
                        <strong>{{author}}</strong>
                        <div class="comment-stars">
                            {{#stars}}
                            <i class="{{.}}"></i>
                            {{/stars}}
                        </div>
                        <p>{{content}}</p>
                    </div>
                    {{/product.reviews}}
                </div>

            </section>

        </main>
    </div>

    <script>
        function changeImage(thumbnail, imageUrl) {
            // Cambiar la imagen principal
            document.getElementById('mainProductImage').src = imageUrl;

            // Actualizar el estado activo de los thumbnails
            document.querySelectorAll('.thumbnail').forEach(thumb => {
                thumb.classList.remove('active');
            });
            thumbnail.classList.add('active');
        }
    </script>

</body>

</html>